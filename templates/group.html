<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{ group.name }} | SplitSense</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Inter', sans-serif;
      overflow-x: hidden;
      background: #0b0f14;
      color: #e5e7eb;
    }

    h1, h2 {
      font-family: 'Space Grotesk', sans-serif;
      letter-spacing: -0.02em;
    }

    /* ===== BACKGROUND ===== */
    #atmosphere {
      position: fixed;
      inset: 0;
      z-index: -1;
      background:
        radial-gradient(900px at 20% 20%, rgba(56,189,248,0.12), transparent),
        radial-gradient(800px at 80% 30%, rgba(16,185,129,0.10), transparent),
        radial-gradient(700px at 50% 90%, rgba(148,163,184,0.08), transparent),
        linear-gradient(180deg, #0b0f14, #0e141b);
      animation: ambientShift 24s ease-in-out infinite;
    }

    @keyframes ambientShift {
      0%,100% { filter: hue-rotate(0deg); }
      50% { filter: hue-rotate(-8deg); }
    }

    .grain {
      position: fixed;
      inset: 0;
      z-index: -1;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.65' numOctaves='4'/%3E%3C/filter%3E%3Crect width='200' height='200' filter='url(%23n)' opacity='.04'/%3E%3C/svg%3E");
      pointer-events: none;
    }

    /* ===== GLASS ===== */
    .glass {
      background: rgba(255,255,255,0.08);
      backdrop-filter: blur(32px);
      -webkit-backdrop-filter: blur(32px);
      border-radius: 24px;
      border: 1px solid rgba(255,255,255,0.12);
      box-shadow:
        0 40px 120px rgba(0,0,0,0.55),
        inset 0 1px 0 rgba(255,255,255,0.08);
    }

    .section-title {
      font-size: clamp(1.1rem, 4vw, 1.35rem);
      font-weight: 600;
      margin-bottom: 1rem;
      color: #e5e7eb;
    }

    .chip {
      background: rgba(255,255,255,0.12);
      border: 1px solid rgba(255,255,255,0.18);
      transition: transform .25s ease, background .25s ease;
    }

    .chip:hover {
      transform: scale(1.05);
      background: rgba(255,255,255,0.2);
    }

    .row {
      background: rgba(255,255,255,0.10);
      border: 1px solid rgba(255,255,255,0.15);
    }

    .positive { color: #22c55e; }
    .negative { color: #ef4444; }
    .neutral { color: #9ca3af; }

    .reveal {
      animation: reveal 1s cubic-bezier(.16,1,.3,1) both;
    }

    @keyframes reveal {
      from { opacity: 0; transform: translateY(14px); }
      to { opacity: 1; transform: none; }
    }
  </style>
</head>

<body>

<!-- BACKGROUND -->
<div id="atmosphere"></div>
<div class="grain"></div>

<!-- HEADER -->
<header class="text-center pt-16 sm:pt-20 pb-10 sm:pb-14 reveal px-4">
  <h1 class="font-bold tracking-tight text-white text-3xl sm:text-4xl lg:text-5xl">
    {{ group.name }}
  </h1>
  <p class="mt-3 text-slate-400 text-xs sm:text-sm uppercase tracking-widest">
    {{ group.vibe }}
  </p>
</header>

<!-- CONTENT -->
<main class="max-w-6xl mx-auto px-4 sm:px-6 pb-28 sm:pb-36 grid gap-6 sm:gap-10">

  <!-- MEMBERS -->
  <section class="glass p-5 sm:p-8 reveal">
    <h2 class="section-title">Members</h2>
    <div class="flex flex-wrap gap-2 sm:gap-3">
      {% for m in group.members %}
        <span class="chip px-3 py-1.5 sm:px-4 sm:py-2 rounded-full text-xs sm:text-sm font-medium">
          {{ m }}
        </span>
      {% endfor %}
    </div>
  </section>

  <!-- ADD EXPENSE -->
  <section class="glass p-5 sm:p-8 reveal">
    <h2 class="section-title">Add Expense</h2>

    <form action="/add-expense/{{ group.id }}" method="POST" class="grid gap-4 sm:gap-5">

      <input name="title" placeholder="Expense title"
        class="w-full px-4 sm:px-5 py-3 sm:py-4 rounded-2xl bg-transparent border border-white/20 text-white outline-none"/>

      <input name="amount" type="number" placeholder="Amount ₹"
        class="w-full px-4 sm:px-5 py-3 sm:py-4 rounded-2xl bg-transparent border border-white/20 text-white outline-none"/>

      <select name="paid_by"
        class="w-full px-4 sm:px-5 py-3 sm:py-4 rounded-2xl bg-transparent border border-white/20 text-white outline-none">
        {% for m in group.members %}
          <option value="{{ m }}">{{ m }}</option>
        {% endfor %}
      </select>

      <div class="flex flex-wrap gap-2 sm:gap-3">
        {% for m in group.members %}
          <label class="chip flex items-center gap-2 px-3 py-1.5 sm:px-4 sm:py-2 rounded-full text-xs sm:text-sm">
            <input type="checkbox" name="split_between" value="{{ m }}" checked>
            {{ m }}
          </label>
        {% endfor %}
      </div>

      <button
        class="mt-2 bg-white/90 hover:bg-emerald-400 text-black py-3 sm:py-4 rounded-2xl text-sm sm:text-lg font-semibold transition">
        Add Expense →
      </button>
    </form>
  </section>

  <!-- EXPENSES -->
  <section class="glass p-5 sm:p-8 reveal">
    <h2 class="section-title">Expenses</h2>

    {% if group.expenses %}
      <ul class="space-y-2 sm:space-y-3">
        {% for e in group.expenses %}
          <li class="row flex justify-between items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-xl text-xs sm:text-sm">
            <span class="text-slate-200 truncate max-w-[70%]">
              {{ e.title }}
            </span>
            <span class="font-semibold text-white">
              ₹{{ e.amount }}
            </span>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="text-slate-400 text-sm">No expenses yet</p>
    {% endif %}
  </section>

  <!-- BALANCES -->
  <section class="glass p-5 sm:p-8 reveal">
    <h2 class="section-title">Balances</h2>

    <ul class="space-y-2 sm:space-y-3">
      {% for person, amount in balances.items() %}
        <li class="flex justify-between text-xs sm:text-sm font-medium">
          <span class="text-slate-300">{{ person }}</span>
          <span class="{% if amount > 0 %}positive{% elif amount < 0 %}negative{% else %}neutral{% endif %}">
            {% if amount > 0 %}
              +₹{{ amount }}
            {% elif amount < 0 %}
              −₹{{ -amount }}
            {% else %}
              settled
            {% endif %}
          </span>
        </li>
      {% endfor %}
    </ul>
  </section>

  <!-- SETTLEMENTS -->
  <section class="glass p-5 sm:p-8 reveal">
    <h2 class="section-title">Settle Up</h2>
    {% for t in settlements %}
      <p class="text-slate-300 text-xs sm:text-sm mb-2">{{ t }}</p>
    {% endfor %}
  </section>

</main>

</body>
</html>
